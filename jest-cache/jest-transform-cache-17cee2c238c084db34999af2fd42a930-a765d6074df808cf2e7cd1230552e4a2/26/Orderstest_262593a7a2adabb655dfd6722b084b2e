05afaf29b796ad5934af7b73cd511748
"use strict";

_getJestObj().mock('Api/orders.service', function () {
  return {
    takeOrder: jest.fn()
  };
});

_getJestObj().mock('react-redux', function () {
  return {
    useDispatch: jest.fn(),
    useSelector: jest.fn(),
    useHistory: function useHistory() {
      return {
        push: jest.fn()
      };
    }
  };
});

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _react = _interopRequireDefault(require("react"));

var _faker = _interopRequireDefault(require("faker"));

var _react2 = require("@testing-library/react");

var _reactRedux = require("react-redux");

var _orders = _interopRequireDefault(require("Api/orders.service"));

var _OrdersList = _interopRequireDefault(require("Components/OrdersList"));

var _OrderCard = _interopRequireDefault(require("Components/OrderCard"));

var _ViewOrderModal = _interopRequireDefault(require("Components/Modals/ViewOrderModal"));

var _SuccessModal = _interopRequireDefault(require("Components/Modals/SuccessModal"));

function _getJestObj() {
  var _require = require("@jest/globals"),
      jest = _require.jest;

  _getJestObj = function _getJestObj() {
    return jest;
  };

  return jest;
}

describe('Orders', function () {
  beforeEach(function () {
    _reactRedux.useSelector.mockImplementation(function (selector) {
      return selector({
        logUser: {
          data: {
            documentNumber: '232323'
          },
          loggedIn: false
        }
      });
    });
  });
  var openModal = jest.fn();
  var viewportSize = jest.fn();
  test('Shows the title', function () {
    var props = {
      order: {
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }
    };

    var _render = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrderCard["default"], {
      order: props.order,
      viewportSize: viewportSize,
      openModal: openModal
    })),
        getByText = _render.getByText;

    expect(getByText(props.order.title)).toBeInTheDocument();
  });
  test('Shows the helpee', function () {
    var props = {
      order: {
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: {
          name: _faker["default"].name.firstName(),
          lastname: _faker["default"].name.lastName()
        },
        categories: [{
          label: 'Supermercado'
        }]
      }
    };

    var _render2 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrderCard["default"], {
      order: props.order,
      viewportSize: viewportSize,
      openModal: openModal
    })),
        getByText = _render2.getByText;

    expect(getByText("".concat(props.order.helpee.name, " ").concat(props.order.helpee.lastname))).toBeInTheDocument();
  });
  test('Shows the description', function () {
    var props = {
      order: {
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }
    };

    var _render3 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrderCard["default"], {
      order: props.order,
      viewportSize: viewportSize,
      openModal: openModal
    })),
        getByText = _render3.getByText;

    expect(getByText(props.order.description)).toBeInTheDocument();
  });
  test('Open modal', function () {
    var props = {
      order: {
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }
    };

    var _render4 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrderCard["default"], {
      order: props.order,
      viewportSize: "small",
      openModal: openModal
    })),
        getByText = _render4.getByText;

    _react2.fireEvent.click(getByText(/Ver más/i));

    expect(openModal).toHaveBeenCalledTimes(1);
  });
  test('Shows orders', function () {
    var props = {
      orders: [{
        id: _faker["default"].random.number(),
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }]
    };
    var setLoading = jest.fn();

    var _render5 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrdersList["default"], {
      orders: props.orders,
      setLoading: setLoading
    })),
        getByText = _render5.getByText;

    expect(getByText(props.orders[0].description)).toBeInTheDocument();
  });
  test('Shows more', function () {
    var props = {
      orders: [{
        id: _faker["default"].random.number(),
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }]
    };
    var setLoading = jest.fn();

    var _render6 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrdersList["default"], {
      orders: props.orders,
      setLoading: setLoading
    })),
        getByText = _render6.getByText;

    _react2.fireEvent.click(getByText(/Ver más/i));

    expect(getByText(/Categorías/i)).toBeInTheDocument();
  });
  test('Cancel view more', function () {
    var props = {
      orders: [{
        id: _faker["default"].random.number(),
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }]
    };
    var setLoading = jest.fn();

    var _render7 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrdersList["default"], {
      orders: props.orders,
      setLoading: setLoading
    })),
        getByText = _render7.getByText,
        getAllByText = _render7.getAllByText;

    _react2.fireEvent.click(getByText(/Ver más/i));

    _react2.fireEvent.click(getAllByText(/Cancelar/i)[1]);

    expect(getAllByText(props.orders[0].description)[0]).toBeInTheDocument();
  });
  test('Take order', /*#__PURE__*/(0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee() {
    var props, setLoading, _render8, getByText, getAllByText;

    return _regenerator["default"].wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            props = {
              orders: [{
                id: _faker["default"].random.number(),
                description: _faker["default"].lorem.paragraph(),
                title: _faker["default"].random.words(),
                helpee: _faker["default"].internet.userName(),
                categories: [{
                  label: 'Supermercado'
                }]
              }]
            };

            _orders["default"].takeOrder.mockImplementation(function () {
              return {
                status: 200
              };
            });

            setLoading = jest.fn();
            _render8 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrdersList["default"], {
              orders: props.orders,
              setLoading: setLoading
            })), getByText = _render8.getByText, getAllByText = _render8.getAllByText;

            _react2.fireEvent.click(getByText(/Ver más/i));

            _context.next = 7;
            return _react2.fireEvent.click(getAllByText(/Postularse/i)[2]);

          case 7:
            _context.next = 9;
            return (0, _react2.waitFor)(function () {
              expect(getByText(/Ha tomado la orden! Gracias por ayudar!/i)).toBeInTheDocument();
            });

          case 9:
          case "end":
            return _context.stop();
        }
      }
    }, _callee);
  })));
  test('Take order modal', /*#__PURE__*/(0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee2() {
    var props, onClose, onConfirm, _render9, getAllByText;

    return _regenerator["default"].wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            props = {
              order: {
                id: _faker["default"].random.number(),
                description: _faker["default"].lorem.paragraph(),
                title: _faker["default"].random.words(),
                helpee: _faker["default"].internet.userName(),
                categories: [{
                  label: 'Supermercado'
                }]
              }
            };
            onClose = jest.fn();
            onConfirm = jest.fn();
            _render9 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_ViewOrderModal["default"], {
              order: props.order,
              onClose: onClose,
              onConfirm: onConfirm
            })), getAllByText = _render9.getAllByText;

            _react2.fireEvent.click(getAllByText(/Postularse/i)[3]);

            _context2.next = 7;
            return (0, _react2.waitFor)(function () {
              expect(onConfirm).toHaveBeenCalledTimes(1);
              expect(onClose).toHaveBeenCalledTimes(1);
            });

          case 7:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2);
  })));
  describe('Success modal for application', function () {
    test('ok button', function () {
      var setShow = jest.fn();
      (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_SuccessModal["default"], {
        message: "Ha tomado la orden! Gracias por ayudar!",
        show: true,
        setShow: setShow
      }));

      _react2.fireEvent.click(document.getElementById('close-ok-modal'));

      expect(setShow).toHaveBeenCalledTimes(1);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk9yZGVycy50ZXN0LmpzIl0sIm5hbWVzIjpbIm1vY2siLCJ0YWtlT3JkZXIiLCJqZXN0IiwiZm4iLCJ1c2VEaXNwYXRjaCIsInVzZVNlbGVjdG9yIiwidXNlSGlzdG9yeSIsInB1c2giLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJtb2NrSW1wbGVtZW50YXRpb24iLCJzZWxlY3RvciIsImxvZ1VzZXIiLCJkYXRhIiwiZG9jdW1lbnROdW1iZXIiLCJsb2dnZWRJbiIsIm9wZW5Nb2RhbCIsInZpZXdwb3J0U2l6ZSIsInRlc3QiLCJwcm9wcyIsIm9yZGVyIiwiZGVzY3JpcHRpb24iLCJmYWtlciIsImxvcmVtIiwicGFyYWdyYXBoIiwidGl0bGUiLCJyYW5kb20iLCJ3b3JkcyIsImhlbHBlZSIsImludGVybmV0IiwidXNlck5hbWUiLCJjYXRlZ29yaWVzIiwibGFiZWwiLCJnZXRCeVRleHQiLCJleHBlY3QiLCJ0b0JlSW5UaGVEb2N1bWVudCIsIm5hbWUiLCJmaXJzdE5hbWUiLCJsYXN0bmFtZSIsImxhc3ROYW1lIiwiZmlyZUV2ZW50IiwiY2xpY2siLCJ0b0hhdmVCZWVuQ2FsbGVkVGltZXMiLCJvcmRlcnMiLCJpZCIsIm51bWJlciIsInNldExvYWRpbmciLCJnZXRBbGxCeVRleHQiLCJvcmRlcnNTZXJ2aWNlIiwic3RhdHVzIiwib25DbG9zZSIsIm9uQ29uZmlybSIsInNldFNob3ciLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIl0sIm1hcHBpbmdzIjoiOztBQW1CQSxjQUFLQSxJQUFMLENBQVUsb0JBQVYsRUFBZ0M7QUFBQSxTQUFPO0FBQ3JDQyxJQUFBQSxTQUFTLEVBQUVDLElBQUksQ0FBQ0MsRUFBTDtBQUQwQixHQUFQO0FBQUEsQ0FBaEM7O0FBUkEsY0FBS0gsSUFBTCxDQUFVLGFBQVYsRUFBeUI7QUFBQSxTQUFPO0FBQzlCSSxJQUFBQSxXQUFXLEVBQUVGLElBQUksQ0FBQ0MsRUFBTCxFQURpQjtBQUU5QkUsSUFBQUEsV0FBVyxFQUFFSCxJQUFJ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QzlDVSxJQUFBQSxJQUFJLENBQUMsV0FBRCxFQUFjLFlBQU07QUFDdEIsVUFBTWtDLE9BQU8sR0FBR2xELElBQUksQ0FBQ0MsRUFBTCxFQUFoQjtBQUNBLHdDQUNFLGdDQUFDLHdCQUFEO0FBQWMsUUFBQSxPQUFPLEVBQUMseUNBQXRCO0FBQWdFLFFBQUEsSUFBSSxNQUFwRTtBQUFxRSxRQUFBLE9BQU8sRUFBRWlEO0FBQTlFLFFBREY7O0FBR0FaLHdCQUFVQyxLQUFWLENBQWdCWSxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsZ0JBQXhCLENBQWhCOztBQUNBcEIsTUFBQUEsTUFBTSxDQUFDa0IsT0FBRCxDQUFOLENBQWdCVixxQkFBaEIsQ0FBc0MsQ0FBdEM7QUFDRCxLQVBHLENBQUo7QUFRRCxHQVRPLENBQVI7QUFVRCxDQTlMTyxDQUFSIiwic291cmNlc0NvbnRlbnQiOlsiLy8gZXNsaW50LWRpc2FibGUganN4LXByb3BzLW5vLXNwcmVhZGluZ1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBmYWtlciBmcm9tICdmYWtlcic7XG5pbXBvcnQgeyBmaXJlRXZlbnQsIHJlbmRlciwgd2FpdEZvciB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0IHsgdXNlU2VsZWN0b3IgfSBmcm9tICdyZWFjdC1yZWR1eCc7XG5pbXBvcnQgb3JkZXJzU2VydmljZSBmcm9tICdBcGkvb3JkZXJzLnNlcnZpY2UnO1xuaW1wb3J0IE9yZGVycyBmcm9tICdDb21wb25lbnRzL09yZGVyc0xpc3QnO1xuaW1wb3J0IE9yZGVyIGZyb20gJ0NvbXBvbmVudHMvT3JkZXJDYXJkJztcbmltcG9ydCBWaWV3T3JkZXJNb2RhbCBmcm9tICdDb21wb25lbnRzL01vZGFscy9WaWV3T3JkZXJNb2RhbCc7XG5pbXBvcnQgU3VjY2Vzc01vZGFsIGZyb20gJ0NvbXBvbmVudHMvTW9kYWxzL1N1Y2Nlc3NNb2RhbCc7XG5cbmplc3QubW9jaygncmVhY3QtcmVkdXgnLCAoKSA9PiAoe1xuICB1c2VEaXNwYXRjaDogamVzdC5mbigpLFxuICB1c2VTZWxlY3RvcjogamVzdC5mbigpLFxuICB1c2VIaXN0b3J5OiAoKSA9PiAoe1xuICAgIHB1c2g6IGplc3QuZm4oKSxcbiAgfSksXG59KSk7XG5cbmplc3QubW9jaygnQXBpL29yZGVycy5zZXJ2aWNlJywgKCkgPT4gKHtcbiAgdGFrZU9yZGVyOiBqZXN0LmZuKCksXG59KSk7XG5cbmRlc2NyaWJlKCdPcmRlcnMnLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHVzZVNlbGVjdG9yLm1vY2tJbXBsZW1lbnRhdGlvbigoc2VsZWN0b3IpID0+IHNlbGVjdG9yKHtcbiAgICAgIGxvZ1VzZXI6IHtcbiAgICAgICAgZGF0YTogeyBkb2N1bWVudE51bWJlcjogJzIzMjMyMycgfSxcbiAgICAgICAgbG9nZ2VkSW46IGZhbHNlLFxuICAgICAgfSxcbiAgICB9KSk7XG4gIH0pO1xuICBjb25zdCBvcGVuTW9kYWwgPSBqZXN0LmZuKCk7XG4gIGNvbnN0IHZpZXdwb3J0U2l6ZSA9IGplc3QuZm4oKTtcblxuICB0ZXN0KCdTaG93cyB0aGUgdGl0bGUnLCAoKSA9PiB7XG4gICAgY29uc3QgcHJvcHMgPSB7XG4gICAgICBvcmRlcjoge1xuICAgICAgICBkZXNjcmlwdGlvbjogZmFrZXIubG9yZW0ucGFyYWdyYXBoKCksXG4gICAgICAgIHRpdGxlOiBmYWtlci5yYW5kb20ud29yZHMoKSxcbiAgICAgICAgaGVscGVlOiBmYWtlci5pbnRlcm5ldC51c2VyTmFtZSgpLFxuICAgICAgICBjYXRlZ29yaWVzOiBbe1xuICAgICAgICAgIGxhYmVsOiAnU3VwZXJtZXJjYWRvJyxcbiAgICAgICAgfV0sXG4gICAgICB9LFxuICAgIH07XG4gICAgY29uc3QgeyBnZXRCeVRleHQgfSA9IHJlbmRlcig8T3JkZXIgb3JkZXI9e3Byb3BzLm9yZGVyfSB2aWV3cG9ydFNpemU9e3ZpZXdwb3J0U2l6ZX0gb3Blbk1vZGFsPXtvcGVuTW9kYWx9IC8+KTtcblxuICAgIGV4cGVjdChnZXRCeVRleHQocHJvcHMub3JkZXIudGl0bGUpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICB9KTtcblxuICB0ZXN0KCdTaG93cyB0aGUgaGVscGVlJywgKCkgPT4ge1xuICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgb3JkZXI6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IGZha2VyLmxvcmVtLnBhcmFncmFwaCgpLFxuICAgICAgICB0aXRsZTogZmFrZXIucmFuZG9tLndvcmRzKCksXG4gICAgICAgIGhlbHBlZToge1xuICAgICAgICAgIG5hbWU6IGZha2VyLm5hbWUuZmlyc3ROYW1lKCksXG4gICAgICAgICAgbGFzdG5hbWU6IGZha2VyLm5hbWUubGFzdE5hbWUoKSxcbiAgICAgICAgfSxcbiAgICAgICAgY2F0ZWdvcmllczogW3tcbiAgICAgICAgICBsYWJlbDogJ1N1cGVybWVyY2FkbycsXG4gICAgICAgIH1dLFxuICAgICAgfSxcbiAgICB9O1xuICAgIGNvbnN0IHsgZ2V0QnlUZXh0IH0gPSByZW5kZXIoPE9yZGVyIG9yZGVyPXtwcm9wcy5vcmRlcn0gdmlld3BvcnRTaXplPXt2aWV3cG9ydFNpemV9IG9wZW5Nb2RhbD17b3Blbk1vZGFsfSAvPik7XG5cbiAgICBleHBlY3QoZ2V0QnlUZXh0KGAke3Byb3BzLm9yZGVyLmhlbHBlZS5uYW1lfSAke3Byb3BzLm9yZGVyLmhlbHBlZS5sYXN0bmFtZX1gKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgdGVzdCgnU2hvd3MgdGhlIGRlc2NyaXB0aW9uJywgKCkgPT4ge1xuICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgb3JkZXI6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IGZha2VyLmxvcmVtLnBhcmFncmFwaCgpLFxuICAgICAgICB0aXRsZTogZmFrZXIucmFuZG9tLndvcmRzKCksXG4gICAgICAgIGhlbHBlZTogZmFrZXIuaW50ZXJuZXQudXNlck5hbWUoKSxcbiAgICAgICAgY2F0ZWdvcmllczogW3tcbiAgICAgICAgICBsYWJlbDogJ1N1cGVybWVyY2FkbycsXG4gICAgICAgIH1dLFxuICAgICAgfSxcbiAgICB9O1xuICAgIGNvbnN0IHsgZ2V0QnlUZXh0IH0gPSByZW5kZXIoPE9yZGVyIG9yZGVyPXtwcm9wcy5vcmRlcn0gdmlld3BvcnRTaXplPXt2aWV3cG9ydFNpemV9IG9wZW5Nb2RhbD17b3Blbk1vZGFsfSAvPik7XG5cbiAgICBleHBlY3QoZ2V0QnlUZXh0KHByb3BzLm9yZGVyLmRlc2NyaXB0aW9uKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgdGVzdCgnT3BlbiBtb2RhbCcsICgpID0+IHtcbiAgICBjb25zdCBwcm9wcyA9IHtcbiAgICAgIG9yZGVyOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBmYWtlci5sb3JlbS5wYXJhZ3JhcGgoKSxcbiAgICAgICAgdGl0bGU6IGZha2VyLnJhbmRvbS53b3JkcygpLFxuICAgICAgICBoZWxwZWU6IGZha2VyLmludGVybmV0LnVzZXJOYW1lKCksXG4gICAgICAgIGNhdGVnb3JpZXM6IFt7XG4gICAgICAgICAgbGFiZWw6ICdTdXBlcm1lcmNhZG8nLFxuICAgICAgICB9XSxcbiAgICAgIH0sXG4gICAgfTtcbiAgICBjb25zdCB7IGdldEJ5VGV4dCB9ID0gcmVuZGVyKDxPcmRlciBvcmRlcj17cHJvcHMub3JkZXJ9IHZpZXdwb3J0U2l6ZT1cInNtYWxsXCIgb3Blbk1vZGFsPXtvcGVuTW9kYWx9IC8+KTtcbiAgICBmaXJlRXZlbnQuY2xpY2soZ2V0QnlUZXh0KC9WZXIgbcOhcy9pKSk7XG4gICAgZXhwZWN0KG9wZW5Nb2RhbCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICB9KTtcblxuICB0ZXN0KCdTaG93cyBvcmRlcnMnLCAoKSA9PiB7XG4gICAgY29uc3QgcHJvcHMgPSB7XG4gICAgICBvcmRlcnM6IFt7XG4gICAgICAgIGlkOiBmYWtlci5yYW5kb20ubnVtYmVyKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBmYWtlci5sb3JlbS5wYXJhZ3JhcGgoKSxcbiAgICAgICAgdGl0bGU6IGZha2VyLnJhbmRvbS53b3JkcygpLFxuICAgICAgICBoZWxwZWU6IGZha2VyLmludGVybmV0LnVzZXJOYW1lKCksXG4gICAgICAgIGNhdGVnb3JpZXM6IFt7XG4gICAgICAgICAgbGFiZWw6ICdTdXBlcm1lcmNhZG8nLFxuICAgICAgICB9XSxcbiAgICAgIH1dLFxuICAgIH07XG4gICAgY29uc3Qgc2V0TG9hZGluZyA9IGplc3QuZm4oKTtcbiAgICBjb25zdCB7IGdldEJ5VGV4dCB9ID0gcmVuZGVyKDxPcmRlcnMgb3JkZXJzPXtwcm9wcy5vcmRlcnN9IHNldExvYWRpbmc9e3NldExvYWRpbmd9IC8+KTtcblxuICAgIGV4cGVjdChnZXRCeVRleHQocHJvcHMub3JkZXJzWzBdLmRlc2NyaXB0aW9uKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgdGVzdCgnU2hvd3MgbW9yZScsICgpID0+IHtcbiAgICBjb25zdCBwcm9wcyA9IHtcbiAgICAgIG9yZGVyczogW3tcbiAgICAgICAgaWQ6IGZha2VyLnJhbmRvbS5udW1iZXIoKSxcbiAgICAgICAgZGVzY3JpcHRpb246IGZha2VyLmxvcmVtLnBhcmFncmFwaCgpLFxuICAgICAgICB0aXRsZTogZmFrZXIucmFuZG9tLndvcmRzKCksXG4gICAgICAgIGhlbHBlZTogZmFrZXIuaW50ZXJuZXQudXNlck5hbWUoKSxcbiAgICAgICAgY2F0ZWdvcmllczogW3tcbiAgICAgICAgICBsYWJlbDogJ1N1cGVybWVyY2FkbycsXG4gICAgICAgIH1dLFxuICAgICAgfV0sXG4gICAgfTtcbiAgICBjb25zdCBzZXRMb2FkaW5nID0gamVzdC5mbigpO1xuICAgIGNvbnN0IHsgZ2V0QnlUZXh0IH0gPSByZW5kZXIoPE9yZGVycyBvcmRlcnM9e3Byb3BzLm9yZGVyc30gc2V0TG9hZGluZz17c2V0TG9hZGluZ30gLz4pO1xuICAgIGZpcmVFdmVudC5jbGljayhnZXRCeVRleHQoL1ZlciBtw6FzL2kpKTtcbiAgICBleHBlY3QoZ2V0QnlUZXh0KC9DYXRlZ29yw61hcy9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgdGVzdCgnQ2FuY2VsIHZpZXcgbW9yZScsICgpID0+IHtcbiAgICBjb25zdCBwcm9wcyA9IHtcbiAgICAgIG9yZGVyczogW3tcbiAgICAgICAgaWQ6IGZha2VyLnJhbmRvbS5udW1iZXIoKSxcbiAgICAgICAgZGVzY3JpcHRpb246IGZha2VyLmxvcmVtLnBhcmFncmFwaCgpLFxuICAgICAgICB0aXRsZTogZmFrZXIucmFuZG9tLndvcmRzKCksXG4gICAgICAgIGhlbHBlZTogZmFrZXIuaW50ZXJuZXQudXNlck5hbWUoKSxcbiAgICAgICAgY2F0ZWdvcmllczogW3tcbiAgICAgICAgICBsYWJlbDogJ1N1cGVybWVyY2FkbycsXG4gICAgICAgIH1dLFxuICAgICAgfV0sXG4gICAgfTtcbiAgICBjb25zdCBzZXRMb2FkaW5nID0gamVzdC5mbigpO1xuICAgIGNvbnN0IHsgZ2V0QnlUZXh0LCBnZXRBbGxCeVRleHQgfSA9IHJlbmRlcig8T3JkZXJzIG9yZGVycz17cHJvcHMub3JkZXJzfSBzZXRMb2FkaW5nPXtzZXRMb2FkaW5nfSAvPik7XG4gICAgZmlyZUV2ZW50LmNsaWNrKGdldEJ5VGV4dCgvVmVyIG3DoXMvaSkpO1xuICAgIGZpcmVFdmVudC5jbGljayhnZXRBbGxCeVRleHQoL0NhbmNlbGFyL2kpWzFdKTtcbiAgICBleHBlY3QoZ2V0QWxsQnlUZXh0KHByb3BzLm9yZGVyc1swXS5kZXNjcmlwdGlvbilbMF0pLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIHRlc3QoJ1Rha2Ugb3JkZXInLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcHJvcHMgPSB7XG4gICAgICBvcmRlcnM6IFt7XG4gICAgICAgIGlkOiBmYWtlci5yYW5kb20ubnVtYmVyKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBmYWtlci5sb3JlbS5wYXJhZ3JhcGgoKSxcbiAgICAgICAgdGl0bGU6IGZha2VyLnJhbmRvbS53b3JkcygpLFxuICAgICAgICBoZWxwZWU6IGZha2VyLmludGVybmV0LnVzZXJOYW1lKCksXG4gICAgICAgIGNhdGVnb3JpZXM6IFt7XG4gICAgICAgICAgbGFiZWw6ICdTdXBlcm1lcmNhZG8nLFxuICAgICAgICB9XSxcbiAgICAgIH1dLFxuICAgIH07XG4gICAgb3JkZXJzU2VydmljZS50YWtlT3JkZXIubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICh7c3RhdHVzOiAyMDB9KSk7XG4gICAgY29uc3Qgc2V0TG9hZGluZyA9IGplc3QuZm4oKTtcbiAgICBjb25zdCB7IGdldEJ5VGV4dCwgZ2V0QWxsQnlUZXh0IH0gPSByZW5kZXIoPE9yZGVycyBvcmRlcnM9e3Byb3BzLm9yZGVyc30gc2V0TG9hZGluZz17c2V0TG9hZGluZ30gLz4pO1xuICAgIGZpcmVFdmVudC5jbGljayhnZXRCeVRleHQoL1ZlciBtw6FzL2kpKTtcbiAgICBhd2FpdCBmaXJlRXZlbnQuY2xpY2soZ2V0QWxsQnlUZXh0KC9Qb3N0dWxhcnNlL2kpWzJdKTtcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChnZXRCeVRleHQoL0hhIHRvbWFkbyBsYSBvcmRlbiEgR3JhY2lhcyBwb3IgYXl1ZGFyIS9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnVGFrZSBvcmRlciBtb2RhbCcsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBwcm9wcyA9IHtcbiAgICAgIG9yZGVyOiB7XG4gICAgICAgIGlkOiBmYWtlci5yYW5kb20ubnVtYmVyKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBmYWtlci5sb3JlbS5wYXJhZ3JhcGgoKSxcbiAgICAgICAgdGl0bGU6IGZha2VyLnJhbmRvbS53b3JkcygpLFxuICAgICAgICBoZWxwZWU6IGZha2VyLmludGVybmV0LnVzZXJOYW1lKCksXG4gICAgICAgIGNhdGVnb3JpZXM6IFt7XG4gICAgICAgICAgbGFiZWw6ICdTdXBlcm1lcmNhZG8nLFxuICAgICAgICB9XSxcbiAgICAgIH0sXG4gICAgfTtcbiAgICBjb25zdCBvbkNsb3NlID0gamVzdC5mbigpO1xuICAgIGNvbnN0IG9uQ29uZmlybSA9IGplc3QuZm4oKTtcbiAgICBjb25zdCB7IGdldEFsbEJ5VGV4dCB9ID0gcmVuZGVyKFxuICAgICAgPFZpZXdPcmRlck1vZGFsIG9yZGVyPXtwcm9wcy5vcmRlcn0gb25DbG9zZT17b25DbG9zZX0gb25Db25maXJtPXtvbkNvbmZpcm19IC8+XG4gICAgKTtcbiAgICBmaXJlRXZlbnQuY2xpY2soZ2V0QWxsQnlUZXh0KC9Qb3N0dWxhcnNlL2kpWzNdKTtcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChvbkNvbmZpcm0pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICAgIGV4cGVjdChvbkNsb3NlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTdWNjZXNzIG1vZGFsIGZvciBhcHBsaWNhdGlvbicsICgpID0+IHtcbiAgICB0ZXN0KCdvayBidXR0b24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBzZXRTaG93ID0gamVzdC5mbigpO1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8U3VjY2Vzc01vZGFsIG1lc3NhZ2U9XCJIYSB0b21hZG8gbGEgb3JkZW4hIEdyYWNpYXMgcG9yIGF5dWRhciFcIiBzaG93IHNldFNob3c9e3NldFNob3d9IC8+XG4gICAgICApO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9zZS1vay1tb2RhbCcpKTtcbiAgICAgIGV4cGVjdChzZXRTaG93KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXX0=