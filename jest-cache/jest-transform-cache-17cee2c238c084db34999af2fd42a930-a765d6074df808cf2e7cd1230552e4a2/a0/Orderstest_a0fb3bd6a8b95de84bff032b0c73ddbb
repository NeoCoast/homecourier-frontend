4efd30f3d312ceb347f5562081b15b43
"use strict";

_getJestObj().mock('react-redux', function () {
  return {
    useDispatch: jest.fn(),
    useSelector: jest.fn(),
    useHistory: function useHistory() {
      return {
        push: jest.fn()
      };
    }
  };
});

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _react = _interopRequireDefault(require("react"));

var _faker = _interopRequireDefault(require("faker"));

var _react2 = require("@testing-library/react");

var _reactRedux = require("react-redux");

var _orders = _interopRequireDefault(require("Api/orders.service"));

var _OrdersList = _interopRequireDefault(require("Components/OrdersList"));

var _OrderCard = _interopRequireDefault(require("Components/OrderCard"));

var _ViewOrderModal = _interopRequireDefault(require("Components/Modals/ViewOrderModal"));

var _SuccessModal = _interopRequireDefault(require("Components/Modals/SuccessModal"));

function _getJestObj() {
  var _require = require("@jest/globals"),
      jest = _require.jest;

  _getJestObj = function _getJestObj() {
    return jest;
  };

  return jest;
}

describe('Orders', function () {
  beforeEach(function () {
    _reactRedux.useSelector.mockImplementation(function (selector) {
      return selector({
        logUser: {
          data: {
            documentNumber: '232323'
          },
          loggedIn: false
        }
      });
    });
  });
  var openModal = jest.fn();
  var viewportSize = jest.fn();
  test('Shows the title', function () {
    var props = {
      order: {
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }
    };

    var _render = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrderCard["default"], {
      order: props.order,
      viewportSize: viewportSize,
      openModal: openModal
    })),
        getByText = _render.getByText;

    expect(getByText(props.order.title)).toBeInTheDocument();
  });
  test('Shows the helpee', function () {
    var props = {
      order: {
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: {
          name: _faker["default"].name.firstName(),
          lastname: _faker["default"].name.lastName()
        },
        categories: [{
          label: 'Supermercado'
        }]
      }
    };

    var _render2 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrderCard["default"], {
      order: props.order,
      viewportSize: viewportSize,
      openModal: openModal
    })),
        getByText = _render2.getByText;

    expect(getByText("".concat(props.order.helpee.name, " ").concat(props.order.helpee.lastname))).toBeInTheDocument();
  });
  test('Shows the description', function () {
    var props = {
      order: {
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }
    };

    var _render3 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrderCard["default"], {
      order: props.order,
      viewportSize: viewportSize,
      openModal: openModal
    })),
        getByText = _render3.getByText;

    expect(getByText(props.order.description)).toBeInTheDocument();
  });
  test('Open modal', function () {
    var props = {
      order: {
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }
    };

    var _render4 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrderCard["default"], {
      order: props.order,
      viewportSize: "small",
      openModal: openModal
    })),
        getByText = _render4.getByText;

    _react2.fireEvent.click(getByText(/Ver más/i));

    expect(openModal).toHaveBeenCalledTimes(1);
  });
  test('Shows orders', function () {
    var props = {
      orders: [{
        id: _faker["default"].random.number(),
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }]
    };
    var setLoading = jest.fn();

    var _render5 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrdersList["default"], {
      orders: props.orders,
      setLoading: setLoading
    })),
        getByText = _render5.getByText;

    expect(getByText(props.orders[0].description)).toBeInTheDocument();
  });
  test('Shows more', function () {
    var props = {
      orders: [{
        id: _faker["default"].random.number(),
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }]
    };
    var setLoading = jest.fn();

    var _render6 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrdersList["default"], {
      orders: props.orders,
      setLoading: setLoading
    })),
        getByText = _render6.getByText;

    _react2.fireEvent.click(getByText(/Ver más/i));

    expect(getByText(/Categorías/i)).toBeInTheDocument();
  });
  test('Cancel view more', function () {
    var props = {
      orders: [{
        id: _faker["default"].random.number(),
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }]
    };
    var setLoading = jest.fn();

    var _render7 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrdersList["default"], {
      orders: props.orders,
      setLoading: setLoading
    })),
        getByText = _render7.getByText,
        getAllByText = _render7.getAllByText;

    _react2.fireEvent.click(getByText(/Ver más/i));

    _react2.fireEvent.click(getAllByText(/Cancelar/i)[1]);

    expect(getAllByText(props.orders[0].description)[0]).toBeInTheDocument();
  });
  test('Take order', /*#__PURE__*/(0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee() {
    var props, setLoading, _render8, getByText, getAllByText;

    return _regenerator["default"].wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            props = {
              orders: [{
                id: _faker["default"].random.number(),
                description: _faker["default"].lorem.paragraph(),
                title: _faker["default"].random.words(),
                helpee: _faker["default"].internet.userName(),
                categories: [{
                  label: 'Supermercado'
                }]
              }]
            };

            _orders["default"].takeOrder.mockImplementation(function () {
              return null;
            });

            setLoading = jest.fn();
            _render8 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_OrdersList["default"], {
              orders: props.orders,
              setLoading: setLoading
            })), getByText = _render8.getByText, getAllByText = _render8.getAllByText;

            _react2.fireEvent.click(getByText(/Ver más/i));

            _react2.fireEvent.click(getAllByText(/Postularse/i)[1]);

            _context.next = 8;
            return (0, _react2.waitFor)(function () {
              expect(getAllByText(props.orders[0].description)[0]).toBeInTheDocument();
            });

          case 8:
          case "end":
            return _context.stop();
        }
      }
    }, _callee);
  })));
  test('Take order modal', function () {
    var props = {
      order: {
        id: _faker["default"].random.number(),
        description: _faker["default"].lorem.paragraph(),
        title: _faker["default"].random.words(),
        helpee: _faker["default"].internet.userName(),
        categories: [{
          label: 'Supermercado'
        }]
      }
    };
    var onClose = jest.fn();
    var onConfirm = jest.fn();

    var _render9 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_ViewOrderModal["default"], {
      order: props.order,
      onClose: onClose,
      onConfirm: onConfirm
    })),
        getAllByText = _render9.getAllByText;

    _react2.fireEvent.click(getAllByText(/Postularse/i)[2]);

    expect(onConfirm).toHaveBeenCalledTimes(1);
    expect(onClose).toHaveBeenCalledTimes(1);
  });
  describe('Success modal for application', function () {
    test('ok button', function () {
      var setShow = jest.fn();
      (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_SuccessModal["default"], {
        message: "Ha tomado la orden! Gracias por ayudar!",
        show: true,
        setShow: setShow
      }));

      _react2.fireEvent.click(document.getElementById('close-ok-modal'));

      expect(setShow).toHaveBeenCalledTimes(1);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk9yZGVycy50ZXN0LmpzIl0sIm5hbWVzIjpbIm1vY2siLCJ1c2VEaXNwYXRjaCIsImplc3QiLCJmbiIsInVzZVNlbGVjdG9yIiwidXNlSGlzdG9yeSIsInB1c2giLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJtb2NrSW1wbGVtZW50YXRpb24iLCJzZWxlY3RvciIsImxvZ1VzZXIiLCJkYXRhIiwiZG9jdW1lbnROdW1iZXIiLCJsb2dnZWRJbiIsIm9wZW5Nb2RhbCIsInZpZXdwb3J0U2l6ZSIsInRlc3QiLCJwcm9wcyIsIm9yZGVyIiwiZGVzY3JpcHRpb24iLCJmYWtlciIsImxvcmVtIiwicGFyYWdyYXBoIiwidGl0bGUiLCJyYW5kb20iLCJ3b3JkcyIsImhlbHBlZSIsImludGVybmV0IiwidXNlck5hbWUiLCJjYXRlZ29yaWVzIiwibGFiZWwiLCJnZXRCeVRleHQiLCJleHBlY3QiLCJ0b0JlSW5UaGVEb2N1bWVudCIsIm5hbWUiLCJmaXJzdE5hbWUiLCJsYXN0bmFtZSIsImxhc3ROYW1lIiwiZmlyZUV2ZW50IiwiY2xpY2siLCJ0b0hhdmVCZWVuQ2FsbGVkVGltZXMiLCJvcmRlcnMiLCJpZCIsIm51bWJlciIsInNldExvYWRpbmciLCJnZXRBbGxCeVRleHQiLCJvcmRlcnNTZXJ2aWNlIiwidGFrZU9yZGVyIiwib25DbG9zZSIsIm9uQ29uZmlybSIsInNldFNob3ciLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIl0sIm1hcHBpbmdzIjoiOztBQVdBLGNBQUtBLElBQUwsQ0FBVSxhQUFWLEVBQXlCO0FBQUEsU0FBTztBQUM5QkMsSUFBQUEsV0FBVyxFQUFFQyxJQUFJLENBQUNDLEVBQUwsRUFEaUI7QUFFOUJDLElBQUFBLFdBQVcsRUFBRUYsSUFBSSxDQUFDQyxFQUFMLEVBRmlCO0FBRzlCRSxJQUFBQSxVQUFVLEVBQUU7QUFBQSxhQUFPO0FBQ2pCQyxRQUFBQSxJQUFJLEVBQUVKLElBQUksQ0FBQ0MsRUFBTDtBQURXLE9BQVA7QUFBQTtBQUhrQixHQUFQ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QUFDQyxjQUFULENBQXdCLGdCQUF4QixDQUFoQjs7QUFDQXBCLE1BQUFBLE1BQU0sQ0FBQ2tCLE9BQUQsQ0FBTixDQUFnQlYscUJBQWhCLENBQXNDLENBQXRDO0FBQ0QsS0FQRyxDQUFKO0FBUUQsR0FUTyxDQUFSO0FBVUQsQ0E1TE8sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbIi8vIGVzbGludC1kaXNhYmxlIGpzeC1wcm9wcy1uby1zcHJlYWRpbmdcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgZmFrZXIgZnJvbSAnZmFrZXInO1xuaW1wb3J0IHsgZmlyZUV2ZW50LCByZW5kZXIsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCB7IHVzZVNlbGVjdG9yIH0gZnJvbSAncmVhY3QtcmVkdXgnO1xuaW1wb3J0IG9yZGVyc1NlcnZpY2UgZnJvbSAnQXBpL29yZGVycy5zZXJ2aWNlJztcbmltcG9ydCBPcmRlcnMgZnJvbSAnQ29tcG9uZW50cy9PcmRlcnNMaXN0JztcbmltcG9ydCBPcmRlciBmcm9tICdDb21wb25lbnRzL09yZGVyQ2FyZCc7XG5pbXBvcnQgVmlld09yZGVyTW9kYWwgZnJvbSAnQ29tcG9uZW50cy9Nb2RhbHMvVmlld09yZGVyTW9kYWwnO1xuaW1wb3J0IFN1Y2Nlc3NNb2RhbCBmcm9tICdDb21wb25lbnRzL01vZGFscy9TdWNjZXNzTW9kYWwnO1xuXG5qZXN0Lm1vY2soJ3JlYWN0LXJlZHV4JywgKCkgPT4gKHtcbiAgdXNlRGlzcGF0Y2g6IGplc3QuZm4oKSxcbiAgdXNlU2VsZWN0b3I6IGplc3QuZm4oKSxcbiAgdXNlSGlzdG9yeTogKCkgPT4gKHtcbiAgICBwdXNoOiBqZXN0LmZuKCksXG4gIH0pLFxufSkpO1xuXG5kZXNjcmliZSgnT3JkZXJzJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICB1c2VTZWxlY3Rvci5tb2NrSW1wbGVtZW50YXRpb24oKHNlbGVjdG9yKSA9PiBzZWxlY3Rvcih7XG4gICAgICBsb2dVc2VyOiB7XG4gICAgICAgIGRhdGE6IHsgZG9jdW1lbnROdW1iZXI6ICcyMzIzMjMnIH0sXG4gICAgICAgIGxvZ2dlZEluOiBmYWxzZSxcbiAgICAgIH0sXG4gICAgfSkpO1xuICB9KTtcbiAgY29uc3Qgb3Blbk1vZGFsID0gamVzdC5mbigpO1xuICBjb25zdCB2aWV3cG9ydFNpemUgPSBqZXN0LmZuKCk7XG5cbiAgdGVzdCgnU2hvd3MgdGhlIHRpdGxlJywgKCkgPT4ge1xuICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgb3JkZXI6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IGZha2VyLmxvcmVtLnBhcmFncmFwaCgpLFxuICAgICAgICB0aXRsZTogZmFrZXIucmFuZG9tLndvcmRzKCksXG4gICAgICAgIGhlbHBlZTogZmFrZXIuaW50ZXJuZXQudXNlck5hbWUoKSxcbiAgICAgICAgY2F0ZWdvcmllczogW3tcbiAgICAgICAgICBsYWJlbDogJ1N1cGVybWVyY2FkbycsXG4gICAgICAgIH1dLFxuICAgICAgfSxcbiAgICB9O1xuICAgIGNvbnN0IHsgZ2V0QnlUZXh0IH0gPSByZW5kZXIoPE9yZGVyIG9yZGVyPXtwcm9wcy5vcmRlcn0gdmlld3BvcnRTaXplPXt2aWV3cG9ydFNpemV9IG9wZW5Nb2RhbD17b3Blbk1vZGFsfSAvPik7XG5cbiAgICBleHBlY3QoZ2V0QnlUZXh0KHByb3BzLm9yZGVyLnRpdGxlKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgdGVzdCgnU2hvd3MgdGhlIGhlbHBlZScsICgpID0+IHtcbiAgICBjb25zdCBwcm9wcyA9IHtcbiAgICAgIG9yZGVyOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBmYWtlci5sb3JlbS5wYXJhZ3JhcGgoKSxcbiAgICAgICAgdGl0bGU6IGZha2VyLnJhbmRvbS53b3JkcygpLFxuICAgICAgICBoZWxwZWU6IHtcbiAgICAgICAgICBuYW1lOiBmYWtlci5uYW1lLmZpcnN0TmFtZSgpLFxuICAgICAgICAgIGxhc3RuYW1lOiBmYWtlci5uYW1lLmxhc3ROYW1lKCksXG4gICAgICAgIH0sXG4gICAgICAgIGNhdGVnb3JpZXM6IFt7XG4gICAgICAgICAgbGFiZWw6ICdTdXBlcm1lcmNhZG8nLFxuICAgICAgICB9XSxcbiAgICAgIH0sXG4gICAgfTtcbiAgICBjb25zdCB7IGdldEJ5VGV4dCB9ID0gcmVuZGVyKDxPcmRlciBvcmRlcj17cHJvcHMub3JkZXJ9IHZpZXdwb3J0U2l6ZT17dmlld3BvcnRTaXplfSBvcGVuTW9kYWw9e29wZW5Nb2RhbH0gLz4pO1xuXG4gICAgZXhwZWN0KGdldEJ5VGV4dChgJHtwcm9wcy5vcmRlci5oZWxwZWUubmFtZX0gJHtwcm9wcy5vcmRlci5oZWxwZWUubGFzdG5hbWV9YCkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIHRlc3QoJ1Nob3dzIHRoZSBkZXNjcmlwdGlvbicsICgpID0+IHtcbiAgICBjb25zdCBwcm9wcyA9IHtcbiAgICAgIG9yZGVyOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBmYWtlci5sb3JlbS5wYXJhZ3JhcGgoKSxcbiAgICAgICAgdGl0bGU6IGZha2VyLnJhbmRvbS53b3JkcygpLFxuICAgICAgICBoZWxwZWU6IGZha2VyLmludGVybmV0LnVzZXJOYW1lKCksXG4gICAgICAgIGNhdGVnb3JpZXM6IFt7XG4gICAgICAgICAgbGFiZWw6ICdTdXBlcm1lcmNhZG8nLFxuICAgICAgICB9XSxcbiAgICAgIH0sXG4gICAgfTtcbiAgICBjb25zdCB7IGdldEJ5VGV4dCB9ID0gcmVuZGVyKDxPcmRlciBvcmRlcj17cHJvcHMub3JkZXJ9IHZpZXdwb3J0U2l6ZT17dmlld3BvcnRTaXplfSBvcGVuTW9kYWw9e29wZW5Nb2RhbH0gLz4pO1xuXG4gICAgZXhwZWN0KGdldEJ5VGV4dChwcm9wcy5vcmRlci5kZXNjcmlwdGlvbikpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIHRlc3QoJ09wZW4gbW9kYWwnLCAoKSA9PiB7XG4gICAgY29uc3QgcHJvcHMgPSB7XG4gICAgICBvcmRlcjoge1xuICAgICAgICBkZXNjcmlwdGlvbjogZmFrZXIubG9yZW0ucGFyYWdyYXBoKCksXG4gICAgICAgIHRpdGxlOiBmYWtlci5yYW5kb20ud29yZHMoKSxcbiAgICAgICAgaGVscGVlOiBmYWtlci5pbnRlcm5ldC51c2VyTmFtZSgpLFxuICAgICAgICBjYXRlZ29yaWVzOiBbe1xuICAgICAgICAgIGxhYmVsOiAnU3VwZXJtZXJjYWRvJyxcbiAgICAgICAgfV0sXG4gICAgICB9LFxuICAgIH07XG4gICAgY29uc3QgeyBnZXRCeVRleHQgfSA9IHJlbmRlcig8T3JkZXIgb3JkZXI9e3Byb3BzLm9yZGVyfSB2aWV3cG9ydFNpemU9XCJzbWFsbFwiIG9wZW5Nb2RhbD17b3Blbk1vZGFsfSAvPik7XG4gICAgZmlyZUV2ZW50LmNsaWNrKGdldEJ5VGV4dCgvVmVyIG3DoXMvaSkpO1xuICAgIGV4cGVjdChvcGVuTW9kYWwpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgfSk7XG5cbiAgdGVzdCgnU2hvd3Mgb3JkZXJzJywgKCkgPT4ge1xuICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgb3JkZXJzOiBbe1xuICAgICAgICBpZDogZmFrZXIucmFuZG9tLm51bWJlcigpLFxuICAgICAgICBkZXNjcmlwdGlvbjogZmFrZXIubG9yZW0ucGFyYWdyYXBoKCksXG4gICAgICAgIHRpdGxlOiBmYWtlci5yYW5kb20ud29yZHMoKSxcbiAgICAgICAgaGVscGVlOiBmYWtlci5pbnRlcm5ldC51c2VyTmFtZSgpLFxuICAgICAgICBjYXRlZ29yaWVzOiBbe1xuICAgICAgICAgIGxhYmVsOiAnU3VwZXJtZXJjYWRvJyxcbiAgICAgICAgfV0sXG4gICAgICB9XSxcbiAgICB9O1xuICAgIGNvbnN0IHNldExvYWRpbmcgPSBqZXN0LmZuKCk7XG4gICAgY29uc3QgeyBnZXRCeVRleHQgfSA9IHJlbmRlcig8T3JkZXJzIG9yZGVycz17cHJvcHMub3JkZXJzfSBzZXRMb2FkaW5nPXtzZXRMb2FkaW5nfSAvPik7XG5cbiAgICBleHBlY3QoZ2V0QnlUZXh0KHByb3BzLm9yZGVyc1swXS5kZXNjcmlwdGlvbikpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIHRlc3QoJ1Nob3dzIG1vcmUnLCAoKSA9PiB7XG4gICAgY29uc3QgcHJvcHMgPSB7XG4gICAgICBvcmRlcnM6IFt7XG4gICAgICAgIGlkOiBmYWtlci5yYW5kb20ubnVtYmVyKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBmYWtlci5sb3JlbS5wYXJhZ3JhcGgoKSxcbiAgICAgICAgdGl0bGU6IGZha2VyLnJhbmRvbS53b3JkcygpLFxuICAgICAgICBoZWxwZWU6IGZha2VyLmludGVybmV0LnVzZXJOYW1lKCksXG4gICAgICAgIGNhdGVnb3JpZXM6IFt7XG4gICAgICAgICAgbGFiZWw6ICdTdXBlcm1lcmNhZG8nLFxuICAgICAgICB9XSxcbiAgICAgIH1dLFxuICAgIH07XG4gICAgY29uc3Qgc2V0TG9hZGluZyA9IGplc3QuZm4oKTtcbiAgICBjb25zdCB7IGdldEJ5VGV4dCB9ID0gcmVuZGVyKDxPcmRlcnMgb3JkZXJzPXtwcm9wcy5vcmRlcnN9IHNldExvYWRpbmc9e3NldExvYWRpbmd9IC8+KTtcbiAgICBmaXJlRXZlbnQuY2xpY2soZ2V0QnlUZXh0KC9WZXIgbcOhcy9pKSk7XG4gICAgZXhwZWN0KGdldEJ5VGV4dCgvQ2F0ZWdvcsOtYXMvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xuXG4gIHRlc3QoJ0NhbmNlbCB2aWV3IG1vcmUnLCAoKSA9PiB7XG4gICAgY29uc3QgcHJvcHMgPSB7XG4gICAgICBvcmRlcnM6IFt7XG4gICAgICAgIGlkOiBmYWtlci5yYW5kb20ubnVtYmVyKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBmYWtlci5sb3JlbS5wYXJhZ3JhcGgoKSxcbiAgICAgICAgdGl0bGU6IGZha2VyLnJhbmRvbS53b3JkcygpLFxuICAgICAgICBoZWxwZWU6IGZha2VyLmludGVybmV0LnVzZXJOYW1lKCksXG4gICAgICAgIGNhdGVnb3JpZXM6IFt7XG4gICAgICAgICAgbGFiZWw6ICdTdXBlcm1lcmNhZG8nLFxuICAgICAgICB9XSxcbiAgICAgIH1dLFxuICAgIH07XG4gICAgY29uc3Qgc2V0TG9hZGluZyA9IGplc3QuZm4oKTtcbiAgICBjb25zdCB7IGdldEJ5VGV4dCwgZ2V0QWxsQnlUZXh0IH0gPSByZW5kZXIoPE9yZGVycyBvcmRlcnM9e3Byb3BzLm9yZGVyc30gc2V0TG9hZGluZz17c2V0TG9hZGluZ30gLz4pO1xuICAgIGZpcmVFdmVudC5jbGljayhnZXRCeVRleHQoL1ZlciBtw6FzL2kpKTtcbiAgICBmaXJlRXZlbnQuY2xpY2soZ2V0QWxsQnlUZXh0KC9DYW5jZWxhci9pKVsxXSk7XG4gICAgZXhwZWN0KGdldEFsbEJ5VGV4dChwcm9wcy5vcmRlcnNbMF0uZGVzY3JpcHRpb24pWzBdKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICB9KTtcblxuICB0ZXN0KCdUYWtlIG9yZGVyJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgb3JkZXJzOiBbe1xuICAgICAgICBpZDogZmFrZXIucmFuZG9tLm51bWJlcigpLFxuICAgICAgICBkZXNjcmlwdGlvbjogZmFrZXIubG9yZW0ucGFyYWdyYXBoKCksXG4gICAgICAgIHRpdGxlOiBmYWtlci5yYW5kb20ud29yZHMoKSxcbiAgICAgICAgaGVscGVlOiBmYWtlci5pbnRlcm5ldC51c2VyTmFtZSgpLFxuICAgICAgICBjYXRlZ29yaWVzOiBbe1xuICAgICAgICAgIGxhYmVsOiAnU3VwZXJtZXJjYWRvJyxcbiAgICAgICAgfV0sXG4gICAgICB9XSxcbiAgICB9O1xuICAgIG9yZGVyc1NlcnZpY2UudGFrZU9yZGVyLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBudWxsKTtcbiAgICBjb25zdCBzZXRMb2FkaW5nID0gamVzdC5mbigpO1xuICAgIGNvbnN0IHsgZ2V0QnlUZXh0LCBnZXRBbGxCeVRleHQgfSA9IHJlbmRlcig8T3JkZXJzIG9yZGVycz17cHJvcHMub3JkZXJzfSBzZXRMb2FkaW5nPXtzZXRMb2FkaW5nfSAvPik7XG4gICAgZmlyZUV2ZW50LmNsaWNrKGdldEJ5VGV4dCgvVmVyIG3DoXMvaSkpO1xuICAgIGZpcmVFdmVudC5jbGljayhnZXRBbGxCeVRleHQoL1Bvc3R1bGFyc2UvaSlbMV0pO1xuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KGdldEFsbEJ5VGV4dChwcm9wcy5vcmRlcnNbMF0uZGVzY3JpcHRpb24pWzBdKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdUYWtlIG9yZGVyIG1vZGFsJywgKCkgPT4ge1xuICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgb3JkZXI6IHtcbiAgICAgICAgaWQ6IGZha2VyLnJhbmRvbS5udW1iZXIoKSxcbiAgICAgICAgZGVzY3JpcHRpb246IGZha2VyLmxvcmVtLnBhcmFncmFwaCgpLFxuICAgICAgICB0aXRsZTogZmFrZXIucmFuZG9tLndvcmRzKCksXG4gICAgICAgIGhlbHBlZTogZmFrZXIuaW50ZXJuZXQudXNlck5hbWUoKSxcbiAgICAgICAgY2F0ZWdvcmllczogW3tcbiAgICAgICAgICBsYWJlbDogJ1N1cGVybWVyY2FkbycsXG4gICAgICAgIH1dLFxuICAgICAgfSxcbiAgICB9O1xuICAgIGNvbnN0IG9uQ2xvc2UgPSBqZXN0LmZuKCk7XG4gICAgY29uc3Qgb25Db25maXJtID0gamVzdC5mbigpO1xuICAgIGNvbnN0IHsgZ2V0QWxsQnlUZXh0IH0gPSByZW5kZXIoXG4gICAgICA8Vmlld09yZGVyTW9kYWwgb3JkZXI9e3Byb3BzLm9yZGVyfSBvbkNsb3NlPXtvbkNsb3NlfSBvbkNvbmZpcm09e29uQ29uZmlybX0gLz5cbiAgICApO1xuICAgIGZpcmVFdmVudC5jbGljayhnZXRBbGxCeVRleHQoL1Bvc3R1bGFyc2UvaSlbMl0pO1xuICAgIGV4cGVjdChvbkNvbmZpcm0pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICBleHBlY3Qob25DbG9zZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICB9KTtcblxuICBkZXNjcmliZSgnU3VjY2VzcyBtb2RhbCBmb3IgYXBwbGljYXRpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnb2sgYnV0dG9uJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2V0U2hvdyA9IGplc3QuZm4oKTtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFN1Y2Nlc3NNb2RhbCBtZXNzYWdlPVwiSGEgdG9tYWRvIGxhIG9yZGVuISBHcmFjaWFzIHBvciBheXVkYXIhXCIgc2hvdyBzZXRTaG93PXtzZXRTaG93fSAvPlxuICAgICAgKTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2xvc2Utb2stbW9kYWwnKSk7XG4gICAgICBleHBlY3Qoc2V0U2hvdykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19